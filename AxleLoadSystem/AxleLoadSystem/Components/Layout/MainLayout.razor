@inherits LayoutComponentBase
@inject IStringLocalizer<Locales.Layout> localizer
<div class="wrapper">
    <!-- Preloader -->
    @* <div class="preloader flex-column justify-content-center align-items-center">
    <img class="animation__shake" src="dist/img/AdminLTELogo.png" alt="AdminLTELogo" height="60" width="60">
    </div> *@

    <!-- Navbar -->
    <Header />
    <!-- /.navbar -->
    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
        <!-- Brand Logo -->
        <a href="" class="brand-link">
            <img src="dist/img/DECOLogo.png" alt="DECO Logo" class="brand-image custom-logo">
            <span class="brand-text font-weight-light">@localizer["Menu.DSRSystem"]</span>
        </a>

        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Sidebar user panel (optional) -->
            <UserMenu />
            <!-- Sidebar Menu -->
            <nav class="mt-2">
                <NavMenu />
            </nav>
            <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <section class="content">
            <div class="container-fluid">
                <GlobalNotification />
                <ErrorBoundary @ref="errorBoundary">
                    <ChildContent>
                        @Body
                    </ChildContent>
                    <ErrorContent Context="ex">
                        @if (HandleError(@ex) == true)
                        {
                            <div class="alert alert-danger" role="alert">
                                <h5>An Unhandled error occured. Exception: @ex.Message</h5>
                                Stack Trace: @ex.StackTrace
                            </div>
                        }
                    </ErrorContent>
                </ErrorBoundary>
            </div>
        </section>
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer">
        <strong>@localizer["Menu.Copyright"] &copy; @DateTime.Today.Year DECO.</strong>
        @localizer["Menu.Rights"]
        <div class="float-right d-none d-sm-inline-block">
            <b>@localizer["Menu.Versions"]</b> 1.0
        </div>
    </footer>
</div>

<div id="blazor-error-ui">
    An unhandled error has occurred.
    <a href="" class="reload">Reload</a>
    <a class="dismiss">🗙</a>
</div>

<style>
    .custom-logo {
        width: 35px; /* Adjust as per your layout */
        height: 35px; /* Maintain square shape */
        border-radius: 6px; /* Optional: slight rounding for modern look */
        box-shadow: 0 2px 4px rgba(0,0,0,0.2); /* Subtle elevation */
        opacity: 0.9; /* Matches original style */
        object-fit: cover; /* Prevents distortion */
    }
</style>

@code {
    ErrorBoundary errorBoundary;
    protected override void OnParametersSet()
    {
        // On each page navigation, reset any error state
        errorBoundary?.Recover();
    }

    private bool HandleError(Exception ex)
    {
        var msg = ex.Message;
        var trace = ex.StackTrace;
        // examine error here
        return true;
    }
}